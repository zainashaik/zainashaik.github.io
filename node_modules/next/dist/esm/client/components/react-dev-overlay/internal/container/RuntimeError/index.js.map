{"version":3,"sources":["../../../../../../../src/client/components/react-dev-overlay/internal/container/RuntimeError/index.tsx"],"sourcesContent":["import * as React from 'react'\nimport { CodeFrame } from '../../components/CodeFrame'\nimport type { ReadyRuntimeError } from '../../helpers/get-error-by-type'\nimport { noop as css } from '../../helpers/noop-template'\nimport { groupStackFramesByFramework } from '../../helpers/group-stack-frames-by-framework'\nimport { GroupedStackFrames } from './GroupedStackFrames'\n\nexport type RuntimeErrorProps = { error: ReadyRuntimeError }\n\nexport function RuntimeError({ error }: RuntimeErrorProps) {\n  const { firstFrame, allLeadingFrames, allCallStackFrames } =\n    React.useMemo(() => {\n      const filteredFrames = error.frames\n        // Filter out nodejs internal frames since you can't do anything about them.\n        // e.g. node:internal/timers shows up pretty often due to timers, but not helpful to users.\n        // Only present the last line before nodejs internal trace.\n        .filter((f) => !f.sourceStackFrame.file?.startsWith('node:'))\n\n      const firstFirstPartyFrameIndex = filteredFrames.findIndex(\n        (entry) =>\n          entry.expanded &&\n          Boolean(entry.originalCodeFrame) &&\n          Boolean(entry.originalStackFrame)\n      )\n\n      return {\n        firstFrame: filteredFrames[firstFirstPartyFrameIndex] ?? null,\n        allLeadingFrames:\n          firstFirstPartyFrameIndex < 0\n            ? []\n            : filteredFrames.slice(0, firstFirstPartyFrameIndex),\n        allCallStackFrames: filteredFrames.slice(firstFirstPartyFrameIndex + 1),\n      }\n    }, [error.frames])\n\n  const { leadingFramesGroupedByFramework, stackFramesGroupedByFramework } =\n    React.useMemo(() => {\n      const leadingFrames = allLeadingFrames.filter((f) => f.expanded)\n\n      return {\n        stackFramesGroupedByFramework:\n          groupStackFramesByFramework(allCallStackFrames),\n\n        leadingFramesGroupedByFramework:\n          groupStackFramesByFramework(leadingFrames),\n      }\n    }, [allCallStackFrames, allLeadingFrames])\n\n  return (\n    <React.Fragment>\n      {firstFrame ? (\n        <React.Fragment>\n          <h2>Source</h2>\n          <GroupedStackFrames\n            groupedStackFrames={leadingFramesGroupedByFramework}\n          />\n          <CodeFrame\n            stackFrame={firstFrame.originalStackFrame!}\n            codeFrame={firstFrame.originalCodeFrame!}\n          />\n        </React.Fragment>\n      ) : undefined}\n\n      {stackFramesGroupedByFramework.length ? (\n        <React.Fragment>\n          <h2>Call Stack</h2>\n\n          <GroupedStackFrames\n            groupedStackFrames={stackFramesGroupedByFramework}\n          />\n        </React.Fragment>\n      ) : undefined}\n    </React.Fragment>\n  )\n}\n\nexport const styles = css`\n  [data-nextjs-call-stack-frame]:not(:last-child),\n  [data-nextjs-component-stack-frame]:not(:last-child) {\n    margin-bottom: var(--size-gap-double);\n  }\n\n  [data-nextjs-data-runtime-error-copy-button],\n  [data-nextjs-data-runtime-error-copy-button]:focus:not(:focus-visible) {\n    position: relative;\n    margin-left: var(--size-gap);\n    padding: 0;\n    border: none;\n    background: none;\n    outline: none;\n  }\n  [data-nextjs-data-runtime-error-copy-button] > svg {\n    vertical-align: middle;\n  }\n  .nextjs-data-runtime-error-copy-button {\n    color: inherit;\n  }\n  .nextjs-data-runtime-error-copy-button--initial:hover {\n    cursor: pointer;\n  }\n  .nextjs-data-runtime-error-copy-button[aria-disabled='true'] {\n    opacity: 0.3;\n    cursor: not-allowed;\n  }\n  .nextjs-data-runtime-error-copy-button--error,\n  .nextjs-data-runtime-error-copy-button--error:hover {\n    color: var(--color-ansi-red);\n  }\n  .nextjs-data-runtime-error-copy-button--success {\n    color: var(--color-ansi-green);\n  }\n\n  [data-nextjs-call-stack-frame] > h3,\n  [data-nextjs-component-stack-frame] > h3 {\n    margin-top: 0;\n    margin-bottom: var(--size-gap);\n    font-family: var(--font-stack-monospace);\n    font-size: var(--size-font);\n    color: #666;\n  }\n  [data-nextjs-call-stack-frame] > h3[data-nextjs-frame-expanded='false'] {\n    color: #666;\n  }\n  [data-nextjs-call-stack-frame] > div,\n  [data-nextjs-component-stack-frame] > div {\n    display: flex;\n    align-items: center;\n    padding-left: calc(var(--size-gap) + var(--size-gap-half));\n    font-size: var(--size-font-small);\n    color: #999;\n  }\n  [data-nextjs-call-stack-frame] > div > svg,\n  [data-nextjs-component-stack-frame] > [role='link'] > svg {\n    width: auto;\n    height: var(--size-font-small);\n    margin-left: var(--size-gap);\n    flex-shrink: 0;\n    display: none;\n  }\n\n  [data-nextjs-call-stack-frame] > div[data-has-source],\n  [data-nextjs-component-stack-frame] > [role='link'] {\n    cursor: pointer;\n  }\n  [data-nextjs-call-stack-frame] > div[data-has-source]:hover,\n  [data-nextjs-component-stack-frame] > [role='link']:hover {\n    text-decoration: underline dotted;\n  }\n  [data-nextjs-call-stack-frame] > div[data-has-source] > svg,\n  [data-nextjs-component-stack-frame] > [role='link'] > svg {\n    display: unset;\n  }\n\n  [data-nextjs-call-stack-framework-icon] {\n    margin-right: var(--size-gap);\n  }\n  [data-nextjs-call-stack-framework-icon='next'] > mask {\n    mask-type: alpha;\n  }\n  [data-nextjs-call-stack-framework-icon='react'] {\n    color: rgb(20, 158, 202);\n  }\n  [data-nextjs-collapsed-call-stack-details][open]\n    [data-nextjs-call-stack-chevron-icon] {\n    transform: rotate(90deg);\n  }\n  [data-nextjs-collapsed-call-stack-details] summary {\n    display: flex;\n    align-items: center;\n    margin-bottom: var(--size-gap);\n    list-style: none;\n  }\n  [data-nextjs-collapsed-call-stack-details] summary::-webkit-details-marker {\n    display: none;\n  }\n\n  [data-nextjs-collapsed-call-stack-details] h3 {\n    color: #666;\n  }\n  [data-nextjs-collapsed-call-stack-details] [data-nextjs-call-stack-frame] {\n    margin-bottom: var(--size-gap-double);\n  }\n\n  [data-nextjs-container-errors-pseudo-html] {\n    position: relative;\n  }\n  [data-nextjs-container-errors-pseudo-html-collapse] {\n    position: absolute;\n    left: 10px;\n    top: 10px;\n    color: inherit;\n    background: none;\n    border: none;\n    padding: 0;\n  }\n  [data-nextjs-container-errors-pseudo-html--diff='add'] {\n    color: var(--color-ansi-green);\n  }\n  [data-nextjs-container-errors-pseudo-html--diff='remove'] {\n    color: var(--color-ansi-red);\n  }\n  [data-nextjs-container-errors-pseudo-html--tag-error] {\n    color: var(--color-ansi-red);\n    font-weight: bold;\n  }\n  /* hide but text are still accessible in DOM */\n  [data-nextjs-container-errors-pseudo-html--hint] {\n    display: inline-block;\n    font-size: 0;\n  }\n  [data-nextjs-container-errors-pseudo-html--tag-adjacent='false'] {\n    color: var(--color-accents-1);\n  }\n`\n"],"names":["React","CodeFrame","noop","css","groupStackFramesByFramework","GroupedStackFrames","RuntimeError","error","firstFrame","allLeadingFrames","allCallStackFrames","useMemo","filteredFrames","frames","filter","f","sourceStackFrame","file","startsWith","firstFirstPartyFrameIndex","findIndex","entry","expanded","Boolean","originalCodeFrame","originalStackFrame","slice","leadingFramesGroupedByFramework","stackFramesGroupedByFramework","leadingFrames","Fragment","h2","groupedStackFrames","stackFrame","codeFrame","undefined","length","styles"],"mappings":";;;;;;;;;;;AAAA,YAAYA,WAAW,QAAO;AAC9B,SAASC,SAAS,QAAQ,6BAA4B;AAEtD,SAASC,QAAQC,GAAG,QAAQ,8BAA6B;AACzD,SAASC,2BAA2B,QAAQ,gDAA+C;AAC3F,SAASC,kBAAkB,QAAQ,uBAAsB;AAIzD,OAAO,SAASC,aAAa,KAA4B;IAA5B,IAAA,EAAEC,KAAK,EAAqB,GAA5B;IAC3B,MAAM,EAAEC,UAAU,EAAEC,gBAAgB,EAAEC,kBAAkB,EAAE,GACxDV,MAAMW,OAAO,CAAC;QACZ,MAAMC,iBAAiBL,MAAMM,MAAM,AACjC,4EAA4E;QAC5E,2FAA2F;QAC3F,2DAA2D;SAC1DC,MAAM,CAAC,CAACC;gBAAOA;mBAAD,GAACA,2BAAAA,EAAEC,gBAAgB,CAACC,IAAI,qBAAvBF,yBAAyBG,UAAU,CAAC;;QAEtD,MAAMC,4BAA4BP,eAAeQ,SAAS,CACxD,CAACC,QACCA,MAAMC,QAAQ,IACdC,QAAQF,MAAMG,iBAAiB,KAC/BD,QAAQF,MAAMI,kBAAkB;YAItBb;QADd,OAAO;YACLJ,YAAYI,CAAAA,4CAAAA,cAAc,CAACO,0BAA0B,YAAzCP,4CAA6C;YACzDH,kBACEU,4BAA4B,IACxB,EAAE,GACFP,eAAec,KAAK,CAAC,GAAGP;YAC9BT,oBAAoBE,eAAec,KAAK,CAACP,4BAA4B;QACvE;IACF,GAAG;QAACZ,MAAMM,MAAM;KAAC;IAEnB,MAAM,EAAEc,+BAA+B,EAAEC,6BAA6B,EAAE,GACtE5B,MAAMW,OAAO,CAAC;QACZ,MAAMkB,gBAAgBpB,iBAAiBK,MAAM,CAAC,CAACC,IAAMA,EAAEO,QAAQ;QAE/D,OAAO;YACLM,+BACExB,4BAA4BM;YAE9BiB,iCACEvB,4BAA4ByB;QAChC;IACF,GAAG;QAACnB;QAAoBD;KAAiB;IAE3C,qBACE,MAACT,MAAM8B,QAAQ;;YACZtB,2BACC,MAACR,MAAM8B,QAAQ;;kCACb,KAACC;kCAAG;;kCACJ,KAAC1B;wBACC2B,oBAAoBL;;kCAEtB,KAAC1B;wBACCgC,YAAYzB,WAAWiB,kBAAkB;wBACzCS,WAAW1B,WAAWgB,iBAAiB;;;iBAGzCW;YAEHP,8BAA8BQ,MAAM,iBACnC,MAACpC,MAAM8B,QAAQ;;kCACb,KAACC;kCAAG;;kCAEJ,KAAC1B;wBACC2B,oBAAoBJ;;;iBAGtBO;;;AAGV;AAEA,OAAO,MAAME,SAASlC,uBAyIrB"}